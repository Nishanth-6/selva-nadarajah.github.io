---
import BaseLayout from "../layouts/BaseLayout.astro";
import HeaderNav from "../components/HeaderNav.astro";
import Footer from "../components/Footer.astro";
import Section from "../components/Section.astro";
import PersonCard from "../components/PersonCard.astro";
import { getCollection, getEntry } from "astro:content";

const page = await getEntry("pages", "students");
if (!page) throw new Error("Missing content entry: pages/students.md");
const { Content } = await page.render();

const entries = await getCollection("students");
const data = entries[0]?.data as any;

const current = data?.current ?? [];
const alumni = data?.alumni ?? [];
---

<BaseLayout title={`${page.data.title} - Selva Nadarajah`} description={page.data.description ?? ""}>
  <HeaderNav slot="header" />
  <h1>{page.data.title}</h1>

  <Section title="Overview">
    <Content />
  </Section>

  <Section title="Current">
    {current.length === 0 ? (
      <p>No entries yet.</p>
    ) : (
      <div class="grid">
        {current.map((p: any) => (
          <PersonCard {...p} />
        ))}
      </div>
    )}
  </Section>

  <Section title="Alumni">
    {alumni.length === 0 ? (
      <p>No entries yet.</p>
    ) : (
      <div class="grid">
        {alumni.map((p: any) => (
          <PersonCard {...p} />
        ))}
      </div>
    )}
  </Section>

  <Footer slot="footer" />
</BaseLayout>

<style>
.grid {
  display: grid;
  grid-template-columns: repeat(1, minmax(0, 1fr));
  gap: 1rem;
}
@media (min-width: 800px) {
  .grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}
</style>
