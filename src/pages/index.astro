---
import BaseLayout from "../layouts/BaseLayout.astro";
import HeaderNav from "../components/HeaderNav.astro";
import Footer from "../components/Footer.astro";
import Section from "../components/Section.astro";
import Card from "../components/Card.astro";
import { getEntry, getCollection } from "astro:content";

const entry = await getEntry("pages", "home");
if (!entry) throw new Error("Missing content entry: pages/home.md");
const { Content } = await entry.render();

const awardsEntries = await getCollection("awards");
const awardsData = awardsEntries.flatMap((e) => (e.data as any).items);
---

<BaseLayout title={entry.data.title} description={entry.data.description ?? ""}>
  <HeaderNav slot="header" />

  <h1>{entry.data.title}</h1>
  <Content />

  <Section title="Awards and recognition">
    {awardsData?.length ? (
      <ul>
        {awardsData.map((a: any) => (
          <li>
            {a.year ? `${a.year} - ` : ""}{a.title}{a.org ? `, ${a.org}` : ""}{a.url ? ` ` : ""}
            {a.url ? <a href={a.url} target="_blank" rel="noreferrer">Link</a> : null}
          </li>
        ))}
      </ul>
    ) : (
      <p>No awards yet.</p>
    )}
  </Section>

  <Section title="Research areas">
    <div class="grid">
      <Card title="Self-adapting approximations">
        <p>Replace with a 1 to 2 sentence summary from the existing site.</p>
      </Card>
      <Card title="Energy real options">
        <p>Replace with a 1 to 2 sentence summary from the existing site.</p>
      </Card>
      <Card title="Energy and computing nexus">
        <p>Replace with a 1 to 2 sentence summary from the existing site.</p>
      </Card>
    </div>
  </Section>

  <Footer slot="footer" />
</BaseLayout>

<style>
.grid {
  display: grid;
  grid-template-columns: repeat(1, minmax(0, 1fr));
  gap: 1rem;
}
@media (min-width: 800px) {
  .grid {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}
</style>
